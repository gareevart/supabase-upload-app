# Drag & Drop функциональность в текстовом редакторе

## Обзор

Добавлена возможность перетаскивания блоков контента в TipTap редакторе. Пользователи могут легко перемещать параграфы, заголовки, изображения и другие элементы внутри редактора с помощью drag & drop.

## Возможности

### ✅ Поддерживаемые элементы
- Параграфы (`<p>`)
- Заголовки (`<h1>` - `<h6>`)
- Изображения (включая resizable images)
- Списки (`<ul>`, `<ol>`, `<li>`)
- Блоки кода (`<pre>`)
- Цитаты (`<blockquote>`)

### ✅ Функциональность
- **Drag Handle** - появляется при наведении курсора на левый край блока
- **Визуальная обратная связь** - блоки подсвечиваются при наведении
- **Плавные анимации** - переходы и эффекты для лучшего UX
- **Адаптивность** - работает на мобильных устройствах
- **Темная тема** - поддержка dark mode

## Техническая реализация

### Файлы
```
app/components/blog/editor/
├── DragHandleExtension.tsx  # Основное расширение TipTap
├── drag-handle.css         # Стили для drag handle
├── extensions.ts           # Конфигурация расширений
└── test-drag-drop.md      # Инструкции по тестированию
```

### Архитектура

1. **DragHandleExtension** - расширение TipTap, которое:
   - Создает drag handle элемент
   - Отслеживает движения мыши
   - Обрабатывает события drag & drop
   - Управляет позиционированием handle

2. **CSS стили** - обеспечивают:
   - Визуальное оформление drag handle
   - Hover эффекты для блоков
   - Анимации и переходы
   - Адаптивность и темную тему

3. **Интеграция** - расширение подключается к:
   - Основному TipTap редактору
   - Системе расширений
   - CSS стилям редактора

## Использование

### Для пользователей

1. **Откройте редактор** - перейдите к созданию/редактированию поста
2. **Наведите курсор** - на левый край любого блока контента
3. **Увидите drag handle** - небольшую иконку с точками
4. **Захватите и перетащите** - блок в новое место
5. **Отпустите** - блок переместится в новую позицию

### Для разработчиков

```typescript
// Расширение уже подключено в extensions.ts
import { DragHandleExtension } from './DragHandleExtension';

// Конфигурация
DragHandleExtension.configure({
  dragHandleWidth: 20, // Ширина drag handle в пикселях
})
```

## Настройки

### Конфигурация расширения

```typescript
export interface DragHandleOptions {
  dragHandleWidth: number; // Ширина drag handle (по умолчанию: 20px)
}
```

### CSS переменные

```css
/* Можно настроить через CSS переменные */
.drag-handle {
  --handle-width: 1.2rem;
  --handle-height: 1.5rem;
  --handle-color: #6c757d;
  --handle-hover-color: #3b82f6;
}
```

## Совместимость

### Браузеры
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

### Устройства
- ✅ Desktop (полная поддержка)
- ✅ Tablet (полная поддержка)
- ⚠️ Mobile (ограниченная поддержка touch events)

## Известные ограничения

1. **Touch события** - на мобильных устройствах может работать не идеально
2. **Вложенные элементы** - сложные вложенные структуры могут вести себя непредсказуемо
3. **Производительность** - при большом количестве блоков может быть небольшая задержка

## Будущие улучшения

- [ ] Улучшенная поддержка touch событий
- [ ] Drag & drop между разными редакторами
- [ ] Групповое перемещение блоков
- [ ] Undo/Redo для drag & drop операций
- [ ] Клавиатурные шорткаты для перемещения блоков

## Отладка

### Проблемы с отображением drag handle

1. Проверьте, что CSS файл подключен:
```typescript
import "./editor/drag-handle.css";
```

2. Убедитесь, что расширение добавлено в extensions:
```typescript
import { DragHandleExtension } from './DragHandleExtension';
// ...
DragHandleExtension.configure({ dragHandleWidth: 20 })
```

### Проблемы с перетаскиванием

1. Проверьте консоль браузера на ошибки
2. Убедитесь, что `editable` режим включен
3. Проверьте, что нет конфликтующих CSS стилей

## Поддержка

При возникновении проблем:
1. Проверьте консоль браузера
2. Убедитесь в корректности подключения файлов
3. Протестируйте в разных браузерах
4. Создайте issue с подробным описанием проблемы
